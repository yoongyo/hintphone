{% extends 'base.html' %}
{% block content %}
<style>
    body, input {
        font-size:14pt
    }
    input, label {
        vertical-align:middle
    }
    .qrcode-text {
        margin-right:0
    }
    .qrcode-text-btn {
        display:inline-block; background:url(//dab1nmslvvntp.cloudfront.net/wp-content/uploads/2017/07/1499401426qr_icon.svg) 50% 50% no-repeat; height:10em; width:17em; cursor:pointer
    }
    #g {
        position:absolute; overflow:hidden; width:1px; height:1px; opacity:0
    }
</style>
<div style="height:100px"></div>
<div class="container text-center my-5">
    <input style="visibility:hidden;" id="text" type="url" size=16 placeholder="Tracking Code" class="qrcode-text">
    <label class="qrcode-text-btn">
        <input id="g" type=file accept="image/*" capture="environment"
               onchange="openQRCamera(this);" tabindex=-1>
    </label>
    <div class="row mt-3">
        <div class="col-2"></div>
        <div class="col-8">
            <button style="border-color:black" class="form-control btn btn-default" onclick="url();" type="button">힌트 사용</button>
        </div>
        <div class="col-2"></div>
    </div>
</div>


<script src="https://dmla.github.io/jsqrcode/src/qr_packed.js"></script>
<script>
    function openQRCamera(node) {
      var reader = new FileReader();
      reader.onload = function() {
        node.value = "";
        qrcode.callback = function(res) {
          if(res instanceof Error) {
            alert("QR코드가 제대로 입력되지 않았습니다. 다시 카메라 프레임에 맞게 찍어주세요.");
          } else {
            node.parentNode.previousElementSibling.value = res;
            alert("QR코드가 입력되어 해당 힌트를 들을 수 있습니다.");
          }
        };
        qrcode.decode(reader.result);
      };
      reader.readAsDataURL(node.files[0]);
    }
    //function showQRIntro() {
      //return confirm("Use your camera to take a picture of a QR code.");
    //}
    function url(){
        var value = $('#text').val();
        if (value == ""){
            alert("QR 코드를 입력하세요.");
        }else{
            location.href=value;
        }
    }
</script>

{% endblock %}